## Step2 Question

ここからは冒頭の` テーブル定義``サンプルデータ `を再度実行しデータを最初の状態に戻したところから行います

### Q6 新しい商品を 1 回の insert で登録しましょう。

| 商品         | 単価 |
| :----------- | :--- |
| タンクトップ | 1300 |
| ジャンパー   | 2500 |
| ソックス     | 600  |

ヒント　バルクインサートを検索しましょう

```
+----+--------------------+-------+---------------------+---------------------+
| id | name               | price | created_at          | updated_at          |
+----+--------------------+-------+---------------------+---------------------+
|  1 | シャツ             |  1000 | 2021-06-02 01:00:43 | 2021-06-02 01:00:43 |
|  2 | パンツ             |   950 | 2021-06-02 01:00:43 | 2021-06-02 01:00:43 |
|  3 | マフラー           |  1200 | 2021-06-02 01:00:43 | 2021-06-02 01:00:43 |
|  4 | ブルゾン           |  1800 | 2021-06-02 01:00:43 | 2021-06-02 01:00:43 |
|  5 | タンクトップ       |  1300 | 2021-06-02 01:07:17 | 2021-06-02 01:07:17 |
|  6 | ジャンパー         |  2500 | 2021-06-02 01:07:17 | 2021-06-02 01:07:17 |
|  7 | ソックス           |   600 | 2021-06-02 01:07:17 | 2021-06-02 01:07:17 |
+----+--------------------+-------+---------------------+---------------------+
7 rows in set (0.00 sec)
```

### Q6 解答後補足問題

今回の回答に至った insert 文のメリットを考えてみましょう

### Q6 解答後補足問題

時刻カラムの設定をDB側に任せるメリットを考えてみましょう

### Q7 B 商会の受注金額の合計を算出しましょう

抽出例

```
+-----------+
| sum_price |
+-----------+
|     98000 |
+-----------+
1 row in set (0.00 sec)
```

### Q8 商品(itemss)から受注明細(order_details)で使われている商品(items.id,items.name)を求めましょう、3 種類の SQL を作成しましょう

抽出例

```
+---------+--------------+
| item_id | name         |
+---------+--------------+
|       1 | シャツ       |
|       2 | パンツ       |
|       3 | マフラー     |
|       4 | ブルゾン     |
+---------+--------------+
4 rows in set (0.00 sec)
```

ヒント：「inner join」「exists」「in」で一つずつ構築しましょう

### Q9 受注明細(order_details)で使われていない商品(items.id,items.name)を求めましょう、3 種類の SQL を作成しましょう

抽出例

```
+----+--------------------+
| id | name               |
+----+--------------------+
|  5 | タンクトップ       |
|  6 | ジャンパー         |
|  7 | ソックス           |
+----+--------------------+
3 rows in set (0.00 sec)
```

### Q10 全アイテム(items)に存在する商品を受注明細(order_details)から各商品ごとの注文回数(抽出例は item_id が 1~7 固定のものとする)を求めよ、全注文数(all_order)も求めよ

抽出例

```
+-----------+------+------+------+------+------+------+------+
| all_order | 1    | 2    | 3    | 4    | 5    | 6    | 7    |
+-----------+------+------+------+------+------+------+------+
|         7 |    2 |    2 |    2 |    1 |    0 |    0 |    0 |
+-----------+------+------+------+------+------+------+------+
1 row in set (0.00 sec)
```

### Q11 全アイテム(items)に存在する商品を受注明細(order_details)から各商品ごとの注文回数を求めよ(5 分)

抽出例

```
+----+-------+
| id | count |
+----+-------+
|  1 |     2 |
|  2 |     2 |
|  3 |     2 |
|  4 |     1 |
|  5 |     0 |
|  6 |     0 |
|  7 |     0 |
+----+-------+
7 rows in set (0.00 sec)
```

### Q12 全アイテム(items)に存在する商品を受注明細(order_details)から各商品ごとの注文回数を求めよ、全注文数(all_order)も求めよ(5 分) 抽出例

抽出例

```
+-----------+-------+
| all_order | count |
+-----------+-------+
| all_order |     7 |
| 1         |     2 |
| 2         |     2 |
| 3         |     2 |
| 4         |     1 |
| 5         |     0 |
| 6         |     0 |
| 7         |     0 |
+-----------+-------+
8 rows in set (0.00 sec)
```

### Q13 Q11,Q12 で求めた全アイテム(items)に存在する商品を受注明細(order_details)から各商品ごとの注文(order_id)を求めよ、(5 分) 抽出例

抽出例

```
+----+----------+
| id | order_id |
+----+----------+
|  1 | 1,2      |
|  2 | 1,3      |
|  3 | 2,4      |
|  4 | 2        |
|  5 | NULL     |
|  6 | NULL     |
|  7 | NULL     |
+----+----------+
7 rows in set (0.00 sec)
```

### Q13 解答後補足問題

エラーとなる理由を考えてみましょう

```
mysql> select b.id ,group_concat(a.order_id) as order from order_details a right outer join items b on a.item_id = b.id group by b.id;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order from order_details a right outer join items b on a.item_id = b.id group by' at line 1
```

---
